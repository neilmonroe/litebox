//	LiteBox v1.31, Copyright 2014, Joe Mottershaw, https://github.com/joemottershaw/
//	================================================================================

;(function($,g,h,i){var j='liteBox',defaults={revealSpeed:400,background:'rgba(0,0,0,.8)',overlayClose:true,escKey:true,navKey:true,closeTip:'tip-l-fade',closeTipText:'Close',prevTip:'tip-t-fade',prevTipText:'Previous',nextTip:'tip-t-fade',nextTipText:'Next',callbackInit:function(){},callbackBeforeOpen:function(){},callbackAfterOpen:function(){},callbackBeforeClose:function(){},callbackAfterClose:function(){},callbackError:function(){},callbackPrev:function(){},callbackNext:function(){},errorMessage:'Error loading content.'};function liteBox(a,b){this.element=a;this.$element=$(this.element);this.options=$.extend({},defaults,b);this._defaults=defaults;this._name=j;this.init()}function winHeight(){return g.innerHeight?g.innerHeight:$(g).height()}function preloadImageArray(b){$(b).each(function(){var a=new Image();a.src=this;if(a.width>0)$('<img />').attr('src',this).addClass('litebox-preload').appendTo('body').hide()})}liteBox.prototype={init:function(){var a=this;this.$element.on('click',function(e){e.preventDefault();a.openLitebox()});keyEsc=27,keyLeft=37,keyRight=39;$('body').off('keyup').on('keyup',function(e){if(a.options.escKey&&e.keyCode==keyEsc)a.closeLitebox();if(a.options.navKey&&e.keyCode==keyLeft)$('.litebox-prev').trigger('click');if(a.options.navKey&&e.keyCode==keyRight)$('.litebox-next').trigger('click')});this.options.callbackInit.call(this)},openLitebox:function(){var b=this;this.options.callbackBeforeOpen.call(this);b.buildLitebox();var c=this.$element;b.populateLitebox(c);if(b.options.overlayClose)$litebox.on('click',function(e){if(e.target===this||$(e.target).hasClass('litebox-container')||$(e.target).hasClass('litebox-error'))b.closeLitebox()});$close.on('click',function(){b.closeLitebox()});if(this.$element.attr('data-litebox-group')){var b=this,groupName=this.$element.attr('data-litebox-group'),group=$('[data-litebox-group="'+this.$element.attr('data-litebox-group')+'"]');var d=[];$('[data-litebox-group="'+groupName+'"]').each(function(){var a=$(this).attr('href');d.push(a)});preloadImageArray(d);$('.litebox-nav').show();$prevNav.off('click').on('click',function(){b.options.callbackPrev.call(this);var a=group.index(c);c=group.eq(a-1);if(!$(c).length)c=group.last();b.populateLitebox(c)});$nextNav.off('click').on('click',function(){b.options.callbackNext.call(this);var a=group.index(c);c=group.eq(a+1);if(!$(c).length)c=group.first();b.populateLitebox(c)})}this.options.callbackAfterOpen.call(this)},buildLitebox:function(){var a=this;$litebox=$('<div>',{'class':'litebox-overlay'}),$close=$('<div>',{'class':'litebox-close '+this.options.closeTip,'data-tooltip':this.options.closeTipText}),$text=$('<div>',{'class':'litebox-text'}),$error=$('<div class="litebox-error"><span>'+this.options.errorMessage+'</span></div>'),$prevNav=$('<div>',{'class':'litebox-nav litebox-prev '+this.options.prevTip,'data-tooltip':this.options.prevTipText}),$nextNav=$('<div>',{'class':'litebox-nav litebox-next '+this.options.nextTip,'data-tooltip':this.options.nextTipText}),$container=$('<div>',{'class':'litebox-container'}),$loader=$('<div>',{'class':'litebox-loader'});$('body').prepend($litebox.css({'background-color':this.options.background}));$litebox.append($close,$text,$prevNav,$nextNav,$container);$litebox.fadeIn(this.options.revealSpeed)},populateLitebox:function(a){var b=this,href=a.attr('href'),$currentContent=$('.litebox-content');$litebox.append($loader);var c=a.attr('data-litebox-text');if(typeof c=='undefined'||c==''){$('.litebox-text').removeClass('active');$('.litebox-text').html()}else{$('.litebox-text').html(c);$('.litebox-text').addClass('active')}if(href.match(/\.(jpeg|jpg|gif|png|bmp)/i)!==null){var d=$('<img>',{'src':href,'class':'litebox-content'});b.transitionContent('image',$currentContent,d);$('img.litebox-content').imagesLoaded(function(){$loader.remove()});d.error(function(){b.liteboxError();$loader.remove()})}else if(videoURL=href.match(/(youtube|youtu|vimeo|dailymotion|kickstarter)\.(com|be)\/((watch\?v=([-\w]+))|(video\/([-\w]+))|(projects\/([-\w]+)\/([-\w]+))|([-\w]+))/)){var e='';if(videoURL[1]=='youtube')e='http://www.youtube.com/v/'+videoURL[5];if(videoURL[1]=='youtu')e='http://www.youtube.com/v/'+videoURL[3];if(videoURL[1]=='vimeo')e='http://player.vimeo.com/video/'+videoURL[3];if(videoURL[1]=='dailymotion')e='https://www.dailymotion.com/embed/video/'+videoURL[7];if(videoURL[1]=='kickstarter')e='https://www.kickstarter.com/projects/'+videoURL[9]+'/'+videoURL[10]+'/widget/video.html';if(e){var f=$('<iframe>',{'src':e,'frameborder':'0','vspace':'0','hspace':'0','scrolling':'no','allowfullscreen':'','class':'litebox-content','style':'background: #000'});b.transitionContent('embed',$currentContent,f);f.load(function(){$loader.remove()})}}else if(href.substring(0,1)=='#'){if($(href).length){$html=$('<div>',{'class':'litebox-content litebox-inline-html'});$html.append($(href).clone());b.transitionContent('inline',$currentContent,$html)}else{b.liteboxError()}$loader.remove()}else{var f=$('<iframe>',{'src':href,'frameborder':'0','vspace':'0','hspace':'0','scrolling':'auto','class':'litebox-content','allowfullscreen':''});b.transitionContent('iframe',$currentContent,f);f.load(function(){$loader.remove()})}},transitionContent:function(a,b,c){var d=this;if(a!='inline')$container.removeClass('litebox-scroll');b.remove();$container.append(c);if(a=='inline')$container.addClass('litebox-scroll');d.centerContent();$(g).on('resize',function(){d.centerContent()})},centerContent:function(){$litebox.css({'height':winHeight()});$container.css({'line-height':$container.height()+'px'});setTimeout(function(){if(typeof $html!='undefined'&&$('.litebox-inline-html').outerHeight()<$container.height())$('.litebox-inline-html').css({'margin-top':'-'+($('.litebox-inline-html').outerHeight())/2+'px','top':'50%'})},50)},closeLitebox:function(){this.options.callbackBeforeClose.call(this);$litebox.fadeOut(this.options.revealSpeed,function(){$('.litebox-nav').hide();$litebox.empty().remove();$('.litebox-preload').remove()});$('.tipsy').fadeOut(this.options.revealSpeed,function(){$(this).remove()});$('.litebox-prev').off('click');$('.litebox-next').off('click');this.options.callbackAfterClose.call(this)},liteboxError:function(){this.options.callbackError.call(this);$container.append($error)}};$.fn[j]=function(a){return this.each(function(){if(!$.data(this,j))$.data(this,j,new liteBox(this,a))})}})(jQuery,window,document);